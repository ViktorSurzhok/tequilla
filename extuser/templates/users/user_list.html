{% extends 'base.html' %}
{% block title %}Сотрудники{% endblock %}
{% block additional_js %}
    <script type="text/javascript">
        $(document).ready(function() {
            function getNewContent() {
                // сбор данных фильтров
                var avatar = $('#filter-avatar').val(),
                    surname = $('#filter-surname').val(),
                    name = $('#filter-name').val();

                 var filters = '?avatar=' + avatar + '&surname=' + surname + '&name=' + name;
                // запрос нового контента
                $.ajax({
                    url: '{{ filter_user_link }}' + filters,
                    type: 'GET',
                    dataType: 'jsonp',
                    crossDomain: true,
                    success: function (data) {
                        $('#user-list').html(data['users']);
                    }
                });
            }

            $('#filter-avatar').on('change', function() {
                getNewContent();
            });
            $('#filter-surname, #filter-name').on('keyup', function() {
                getNewContent();
            });
        });
    </script>
{% endblock %}
{% block content %}
    <div class="col-md-12">
        <div class="x_panel">
            <div class="x_title">
                <h2>Сотрудники
                    <small>Всего сотрудников: {{ users.count }}</small>
                </h2>
                <ul class="nav navbar-right panel_toolbox">
                    <li class="pull-right"><a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
                    </li>
                </ul>
                <div class="clearfix"></div>
            </div>
            <div class="x_content">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>#</th>
                        <th>
                            <div>
                                Аватар
                            </div>
                            <div class="col-md-7">
                                  <select class="form-control" id="filter-avatar">
                                    <option value=""></option>
                                    <option value="1">Есть</option>
                                    <option value="0">Нет</option>
                                  </select>
                            </div>
                        </th>
                        <th>
                            <div>
                                Фамилия
                            </div>
                            <div class="col-md-12">
                              <input type="text" class="form-control" id="filter-surname">
                            </div>
                        </th>
                        <th>
                            <div>
                                Имя
                            </div>
                            <div class="col-md-12">
                              <input type="text" class="form-control" id="filter-name">
                            </div>
                        </th>
                        <th>Операции</th>
                    </tr>
                    </thead>
                    <tbody id="user-list">
                        {% include 'users/_user_list.html' %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>
{% endblock %}